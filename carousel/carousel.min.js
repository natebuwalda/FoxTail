/** Copyright 2012-2013 Stephen Baker Dragon Bits, LLC. */ (function(b){b.carousel=function(f,h,g,i){var j=!1,a=this;a.timer=!1;a.init=function(){a.settings=b.extend({},b.carousel.defaults,h);("function"!=typeof a.settings.prevBtnInner||"function"!=typeof a.settings.nextBtnInner)&&b.error(g.selector+": prevBtnInner and nextBtnInner must be functions");"continious"==a.settings.mode.toLowerCase()&&(a.settings.transition="slide");if(a.settings.wrapAt){var c,e=b(f).find(a.settings.wrapTag);e.length||b.error(g.selector+': Wrap at was unable to find the set selector "'+
a.settings.wrapTag+'"');e.wrapAll("<ul />").each(function(b){0==b%parseInt(a.settings.wrapAt)&&b&&(c=b,e.slice(b-parseInt(a.settings.wrapAt),b).wrapAll("<li />"))}).slice(c,e.length).wrapAll("<li />")}"ul"!=b(f)[0].nodeName.toLowerCase()?b(f).find("ul").length?a.$ul=b(f).find("ul"):b.error(g.selector+": Carousel requires there be a UL within the provided element"):a.$ul=b(f);a.settings.step||(a.settings.step=a.settings.show);if(("auto"==a.settings.mode.toLowerCase()||"continious"==a.settings.mode.toLowerCase())&&
"none"==a.settings.wrap.toLowerCase())a.settings.wrap="circular";switch(a.settings.direction.toLowerCase()){case "vert":case "tb":case "bt":a.settings.TYPE="vertical";break;case "horz":case "rtl":case "ltr":a.settings.TYPE="horizontal";break;default:b.error(g.selector+": Provided direction is unrecgonized")}switch(a.settings.mode.toLowerCase()){case "auto":a.settings.duration=a.settings.duration?a.settings.duration:3E3;var k=a.settings,d;a:{switch(a.settings.transition.toLowerCase()){case "slide":d=
a.settings.speed?a.settings.speed:250*a.settings.step;break a;case "fade":case "crossfade":case "xfade":d=a.settings.speed?a.settings.speed:500;break a;default:b.error(g.selector+": Unknown transition effect: "+a.settings.transition)}d=void 0}k.speed=d;break;case "continious":a.settings.duration=a.settings.duration?a.settings.duration:800;break;case "manual":k=a.settings;a:{switch(a.settings.transition.toLowerCase()){case "slide":d=a.settings.speed?a.settings.speed:250*a.settings.step;break a;case "fade":case "crossfade":case "xfade":d=
a.settings.speed?a.settings.speed:500;break a;default:b.error(g.selector+": Unknown transition effect: "+a.settings.transition)}d=void 0}k.speed=d;break;default:b.error(g.selector+": Unrecgonized mode")}a.$ul.wrap(b("<div />").addClass("carousel-wrapper").addClass(a.settings.TYPE));a.$ul.wrap(b("<div />").addClass("stage"));a.$ul.wrap(b("<div />").addClass("mask"));a.$ul.addClass("carousel");a.$mask=a.$ul.parent();a.$stage=a.$mask.parent();a.$wrapper=a.$stage.parent();a.settings.buffer&&a.$ul.find(">li").each(function(){if(parseInt(0<
b(this).css("v"==a.settings.TYPE.substr(0,1)?"margin-bottom":"margin-right")))b(this).css("v"==a.settings.TYPE.substr(0,1)?"margin-bottom":"margin-right",0)});a.settings.LIGAP="v"==a.settings.TYPE.substr(0,1)?parseInt(a.$ul.find(">li:eq(0)").css("margin-top"))!=parseInt(a.$ul.find(">li:eq(0)").css("margin-top"))?Math.max(parseInt(a.$ul.find(">li:eq(0)").css("margin-top")),parseInt(a.$ul.find(">li:eq(0)").css("margin-top"))):parseInt(a.$ul.find(">li:eq(0)").css("margin-top")):a.$ul.find(">li:eq(0)").outerWidth(!0)-
a.$ul.find(">li:eq(0)").width();a.settings.USABLEAREA=a.settings.maskSize-a.settings.LIGAP*a.settings.show-(a.settings.buffer?a.settings.LIGAP:0);a.$ul.find(">li").css(a.getSizeTerm(),Math.floor(a.settings.USABLEAREA/a.settings.show));a.settings.LISIZE=("v"==a.settings.TYPE.substr(0,1)?a.$ul.find(">li:eq(0)").height():a.$ul.find(">li:eq(0)").width())+a.settings.LIGAP;a.settings.PAGES=Math.ceil(a.$ul.find(">li").length/a.settings.show);a.settings.MASKSIZE=a.settings.show*a.settings.LISIZE+(a.settings.buffer?
a.settings.LIGAP:0);a.$mask.css(a.getSizeTerm(),a.settings.MASKSIZE+"px");0!=a.settings.USABLEAREA%a.settings.show&&a.$mask.css("v"==a.settings.TYPE.substr(0,1)?"margin-bottom":"margin-right",a.settings.USABLEAREA%a.settings.show);a.$ul.find(">li").each(function(){b(this).data("index",b(this).index())});if("circular"==a.settings.wrap.toLowerCase()){if(0!=a.$ul.find(">li").length%a.settings.show){k=a.$ul.find(">li");for(d=1;d<a.settings.show;d++)a.$ul.append(k.clone(!0).addClass("cloned"))}0==a.$ul.find(">li").length%
a.settings.show&&("xfade"!=a.settings.transition.toLowerCase()&&"crossfade"!=a.settings.transition.toLowerCase())&&(a.$ul.find(">li").slice(-a.settings.show).clone().addClass("cloned").prependTo(a.$ul),a.$ul.find(">li").slice(a.settings.show,2*a.settings.show).clone().addClass("cloned").appendTo(a.$ul));a.$ul.css("v"==a.settings.TYPE.substr(0,1)?"top":"left",-(a.settings.LISIZE*a.settings.show)+"px")}a.$ul.css("v"==a.settings.TYPE.substr(0,1)?"height":"width",a.settings.LISIZE*a.$ul.find(">li").length);
"h"==a.settings.TYPE.substr(0,1)&&(a.$wrapper.find("img").length?b(window).load(function(){a.$mask.css("height",function(){var c=0;a.$ul.find(">li").each(function(){c=b(this).outerHeight(!0)>c?b(this).outerHeight(!0):c});return c}())}):a.$mask.css("height",a.$ul.outerHeight(!0)));if("crossfade"==a.settings.transition.toLowerCase()||"xfade"==a.settings.transition.toLowerCase())e=a.$ul.find(">li"),e.each(function(d){0==d%parseInt(a.settings.show)&&d&&(c=d,e.slice(d-parseInt(a.settings.show),d).wrapAll(b("<ul />")).parent().wrap(b("<li />").addClass("xfade").css(a.getSizeTerm(),
a.$mask.css(a.getSizeTerm()))))}).slice(c,e.length).wrapAll(b("<ul />")).parent().wrap(b("<li />").addClass("xfade").css(a.getSizeTerm(),a.$mask.css(a.getSizeTerm()))),a.$ul.css("v"==a.settings.TYPE.substr(0,1)?"top":"left",0).find(">li:gt(0)").hide(),a.$wrapper.addClass("xfade");a.$wrapper.find("img").length?b(window).load(function(){a.makeControls()}):a.makeControls()};a.rotate=function(c,e){r=!0;a.$ul.add(b(">li",a.$ul)).each(function(){r&&(r=b(this).is(":not(:animated)"))});if(r){var f="number"==
typeof c,e=null==e?a.settings.step:e,d=f?-((c*a.settings.show-a.settings.show)*a.settings.LISIZE+("circular"==a.settings.wrap.toLowerCase()?a.settings.show:0)*a.settings.LISIZE):a.settings.LISIZE*e*("next"==c?-1:1)+a.getCurrentPosition(),g="v"==a.settings.TYPE.substr(0,1)?{top:d+"px"}:{left:d+"px"},h=function(){"circular"==a.settings.wrap.toLowerCase()&&a.executeCircularWrap();$page=b(".pages li",a.$wrapper).length&&1>=a.getCurrentLI()%a.settings.show?b(".pages li",a.$wrapper).removeClass("active").eq(a.getCurrentPage()-
1).addClass("active"):null;a.isAuto()&&a.restartAuto();"function"==typeof a.settings.afterRotate&&a.settings.afterRotate($page||null)},i=function(){if("none"==a.settings.wrap.toLowerCase())if(a.$wrapper.find(".btn").removeClass("disabled"),"crossfade"==a.settings.transition.toLowerCase()||"xfade"==a.settings.transition.toLowerCase())a.$ul.find(">li:visible").is(":first-child")?a.$wrapper.find(".previous").addClass("disabled"):a.$ul.find(">li:visible").is(":last-child")&&a.$wrapper.find(".next").addClass("disabled");
else if(0<=d||d<=-(a.getWidth()-a.settings.show*a.settings.LISIZE))a.$wrapper.find("."+("number"==typeof c&&c>a.getCurrentPage()||"next"==c?"next":"previous")).addClass("disabled")};"function"==typeof a.settings.beforeRotate&&a.settings.beforeRotate(b(".pages li.active",a.$wrapper));switch(!0){case "crossfade"==a.settings.transition.toLowerCase()||"xfade"==a.settings.transition.toLowerCase():var l=a.$ul.find(">li:visible"),j=f?a.$ul.find(">li:eq("+(c-1)+")"):"next"==c?l.next().length?l.next():a.$ul.find(">li:eq(0)"):
l.prev().length?l.prev():a.$ul.find(">li:last");a.isAuto()&&a.stopAuto();l.fadeOut(a.settings.speed);j.fadeIn(a.settings.speed,function(){$page=f?b(".pages li",a.$wrapper).removeClass("active").eq(c-1).addClass("active"):b(".pages li",a.$wrapper).removeClass("active").eq(j.index()).addClass("active");i();a.isAuto()&&a.startAuto();"function"==typeof a.settings.afterRotate&&a.settings.afterRotate($page||null)});break;case "fade"==a.settings.transition.toLowerCase()&&"continious"!=a.settings.mode.toLowerCase():i();
a.$ul.fadeOut(a.settings.speed,function(){a.$ul.css(g).fadeIn(a.settings.speed,h);a.isAuto()&&a.restartAuto()});break;default:i(),a.$ul.animate(g,a.settings.speed,h)}}};a.isAuto=function(){return a.settings.mode.match(/continious|auto/i)};a.restartAuto=function(){a.stopAuto();a.startAuto()};a.startAuto=function(){"continious"==a.settings.mode.toLowerCase()?(a.startContiniousSlide(),a.settings.makePlayPause||(a.$wrapper.mouseenter(function(){a.stopAuto()}),a.$wrapper.mouseleave(function(){a.startContiniousSlide()}))):
a.timer=window.setInterval(function(){switch(a.settings.direction.toLowerCase()){case "vert":case "horz":case "ltr":case "tb":a.rotate("next");break;case "rtl":case "bt":a.rotate("previous");break;default:b.error(g.selector+": Unknown direction supplied")}},a.settings.duration);a.$playPause&&a.$playPause.find(">span").removeClass("play").addClass("pause")};a.stopAuto=function(){"continious"==a.settings.mode.toLowerCase()?a.$ul.stop():a.timer&&window.clearInterval(a.timer);a.$playPause&&a.$playPause.find(">span").removeClass("pause").addClass("play")};
a.startContiniousSlide=function(){var b="v"==a.settings.TYPE.substr(0,1)?{top:-(a.getWidth()-a.settings.show*a.settings.LISIZE)}:{left:-(a.getWidth()-a.settings.show*a.settings.LISIZE)};a.$ul.animate(b,(a.$ul.find(">li").length-2*a.settings.show-a.getCurrentLI())*a.settings.duration,"linear",function(){a.executeCircularWrap();a.startContiniousSlide()})};a.executeCircularWrap=function(){Math.abs(a.getCurrentPosition())>=Math.abs(a.getWidth()-a.settings.show*a.settings.LISIZE)?a.$ul.css("v"==a.settings.TYPE.substr(0,
1)?"top":"left",-(a.settings.show*a.settings.LISIZE)+"px"):0==Math.abs(a.getCurrentPosition())&&a.$ul.css("v"==a.settings.TYPE.substr(0,1)?"top":"left",-(a.getWidth()-2*a.settings.show*a.settings.LISIZE)+"px")};a.getCurrentLI=function(){return Math.abs(a.getCurrentPosition())/a.settings.LISIZE+1-("circular"==a.settings.wrap.toLowerCase()?a.settings.show:0)};a.getCurrentPage=function(){return Math.ceil(a.getCurrentLI()/a.settings.show)};a.getCurrentPosition=function(){return"v"==a.settings.TYPE.substr(0,
1)?a.$ul.position().top:a.$ul.position().left};a.getWidth=function(){return"v"==a.settings.TYPE.substr(0,1)?a.$ul.height():a.$ul.width()};a.bindEvents=function(){("auto"==a.settings.mode.toLowerCase()||"continious"==a.settings.mode.toLowerCase())&&a.startAuto();b(".previous",a.$wrapper).click(function(c){c.preventDefault();a.stopAuto();b(this).is(":not(.disabled)")&&a.rotate("previous")});b(".next",a.$wrapper).click(function(c){c.preventDefault();a.stopAuto();b(this).is(":not(.disabled)")&&a.rotate("next")});
b(".pages li",a.$wrapper).click(function(c){c.preventDefault();b(this).is(":not(.active)")&&a.rotate(b(this).prevAll().length+1)});b(".playPause",a.$wrapper).click(function(){a.$playPause.find(">span").is(".play")?a.startAuto():a.stopAuto()})};a.makeControls=function(){if(!j){a.settings.makeControls&&a.makeBtns();a.settings.makePagination&&("crossfade"==a.settings.transition.toLowerCase()||"xfade"==a.settings.transition.toLowerCase())?(a.settings.PAGES=a.$ul.find(">li.xfade").length,a.makePagination()):
a.settings.makePagination&&("continious"!=a.settings.mode.toLowerCase()&&("circular"!=a.settings.wrap.toLowerCase()||0==a.$ul.find(">li:not(.cloned)").length%a.settings.show))&&a.makePagination();a.settings.makePlayPause&&a.makePlayPause();a.bindEvents();j=!0;if("function"==typeof a.settings.onComplete)a.settings.onComplete(a.settings);"function"==typeof i&&g.filter(":last")[0]===b(f)[0]&&i()}};a.makePlayPause=function(){if("auto"==a.settings.mode.toLowerCase()||"continious"==a.settings.mode.toLowerCase())a.$playPause=
b("<div />").addClass("playPause").append(b("<span />").addClass("play")),a.$wrapper.append(a.$playPause),"h"==a.settings.TYPE.substr(0,1)?a.$wrapper.css("height",a.$wrapper.height()+Math.abs(a.settings.makePagination&&a.$pages?a.$pages.height()-a.$playPause.height():a.$playPause.height())):a.$wrapper.css("width",a.$wrapper.width()+Math.abs(a.settings.makePagination&&a.$pages?a.$pages.width()-a.$playPause.width():a.$playPause.width()))};a.makeBtns=function(){var c=0;a.$mask.before(b("<div />").addClass("previous btn"+
("none"==a.settings.wrap.toLowerCase()?" disabled":"")).html(b("<span />").html(a.settings.prevBtnInner())));a.$mask.after(b("<div />").addClass("next btn"+("none"==a.settings.wrap.toLowerCase()&&2>a.settings.PAGES?" disabled":"")).html(b("<span />").html(a.settings.nextBtnInner())));if("absolute"!=a.$stage.find(".btn").css("position").toLowerCase())if("v"==a.settings.TYPE.substr(0,1))a.$stage.find(".btn").css("width",a.$mask.width()),a.$stage.find(".btn").each(function(){c+=b(this).outerHeight(!0)}),
a.$stage.css("height",a.$mask.outerHeight(!0)+c),a.$wrapper.css("height",a.$stage.outerHeight(!0));else if("h"==a.settings.TYPE.substr(0,1)){var e=parseInt(a.$stage.find(".btn:eq(0) span").css("min-height"));a.$stage.find(".btn").each(function(){c+=b(this).outerWidth(!0)});a.$stage.css("width",a.$mask.outerWidth(!0)+c);a.$wrapper.css("width",a.$stage.outerWidth(!0));a.$stage.find(".btn").css("height",a.$mask.height()>e?a.$mask.height():e).find("span").css("margin-top","-"+Math.floor(a.$stage.find(".btn span:eq(0)").outerHeight(!0)/
2)+"px")}else b.error(g.selector+": Unable to size buttons due to unrecgonized TYPE value")};a.makePagination=function(){for(var c=b("<ul />").addClass("pages"),e=1;e<=a.settings.PAGES;e++)c.append(b("<li />").html(a.settings.pageInner(e)).attr("rel",e));a.$pages=c;a.$pages.find("li:first-child").addClass("active");a.$wrapper.append(a.$pages);"v"==a.settings.TYPE.substr(0,1)?(a.$pages.css("margin-top","-"+Math.floor(a.$pages.height()/2)+"px"),a.$mask.css("width",a.$wrapper.outerWidth(!0)-a.$pages.outerWidth(!0)-
a.$pages.find(">li:eq(0)").outerHeight(!0)+"px")):"h"==a.settings.TYPE.substr(0,1)?(a.$pages.css("margin-left","-"+Math.floor(a.$pages.width()/2)+"px"),a.$wrapper.height(a.$wrapper.height()+a.$pages.outerHeight(!0))):b.error(g.selector+": Unable to setup pagination due to unrecgonized TYPE value")};a.getSizeTerm=function(){return"v"==a.settings.TYPE.substr(0,1)?"height":"width"};a.init()};b.carousel.defaults={makeControls:!0,makePagination:!1,makePlayPause:!1,direction:"tb",duration:!1,speed:!1,step:!1,
show:4,wrap:"circular",mode:"manual",transition:"slide",buffer:!1,wrapTag:">div",wrapAt:!1,maskSize:88,prevBtnInner:function(){return"&nbsp;"},nextBtnInner:function(){return"&nbsp;"},pageInner:function(){return"&nbsp;"},onComplete:null,beforeRotate:null,afterRotate:null};b.fn.carousel=function(f,h){if("function"==typeof f)if("object"==typeof h)var g=h,h=f,f=g;else h=f,f={};if((typeof f).match("object|undefined")){var i=this;this.each(function(){new b.carousel(this,f,i,h)})}return this}})(jQuery);